From 671b74277c5bdeb7351bcd03a9dd6dd50414fea5 Mon Sep 17 00:00:00 2001
From: Mark Zhuang <mark.zhuang@spacemit.com>
Date: Mon, 12 Aug 2024 09:50:59 +0800
Subject: [PATCH 1075/1451] rtl8852bs: fix compiler warning

Change-Id: I7660e28b47071295fe3c70cd0f13b29079c44015
---
 .../wireless/realtek/rtl8852bs/core/rtw_wlan_util.c  |  2 ++
 .../wireless/realtek/rtl8852bs/include/ieee80211.h   | 12 ++++++------
 .../wireless/realtek/rtl8852bs/include/wlan_bssdef.h |  4 ++--
 .../realtek/rtl8852bs/phl/hal_g6/hal_sound.c         |  1 +
 .../rtl8852bs/phl/hal_g6/mac/mac_ax/security_cam.c   |  4 +++-
 .../realtek/rtl8852bs/phl/hal_g6/phy/bb/halbb_api.c  |  1 +
 .../hal_g6/phy/rf/halrf_8852b/halrf_ops_rtl8852b.h   |  2 +-
 .../rtl8852bs/phl/test/verify/phl_test_verify.c      |  1 +
 8 files changed, 17 insertions(+), 10 deletions(-)

diff --git a/drivers/net/wireless/realtek/rtl8852bs/core/rtw_wlan_util.c b/drivers/net/wireless/realtek/rtl8852bs/core/rtw_wlan_util.c
index b3a1481bcb33..ace2a974f218 100644
--- a/drivers/net/wireless/realtek/rtl8852bs/core/rtw_wlan_util.c
+++ b/drivers/net/wireless/realtek/rtl8852bs/core/rtw_wlan_util.c
@@ -2271,6 +2271,7 @@ unsigned int is_ap_in_tkip(struct _ADAPTER_LINK *padapter_link)
 			case _RSN_IE_2_:
 				if (_rtw_memcmp((pIE->data + 8), RSN_TKIP_CIPHER, 4))
 					return _TRUE;
+				break;
 
 			default:
 				break;
@@ -2308,6 +2309,7 @@ unsigned int should_forbid_n_rate(_adapter *padapter)
 				if ((_rtw_memcmp((pIE->data + 8), RSN_CIPHER_SUITE_CCMP, 4))  ||
 				    (_rtw_memcmp((pIE->data + 12), RSN_CIPHER_SUITE_CCMP, 4)))
 					return _FALSE;
+				break;
 
 			default:
 				break;
diff --git a/drivers/net/wireless/realtek/rtl8852bs/include/ieee80211.h b/drivers/net/wireless/realtek/rtl8852bs/include/ieee80211.h
index bd83191f4d3e..cc8c0ef2e065 100644
--- a/drivers/net/wireless/realtek/rtl8852bs/include/ieee80211.h
+++ b/drivers/net/wireless/realtek/rtl8852bs/include/ieee80211.h
@@ -265,7 +265,7 @@ typedef struct ieee_param {
 		struct {
 			u32 len;
 			u8 reserved[32];
-			u8 data[0];
+			DECLARE_FLEX_ARRAY(u8, data);
 		} wpa_ie;
 		struct {
 			int command;
@@ -278,7 +278,7 @@ typedef struct ieee_param {
 			u8 idx;
 			u8 seq[8]; /* sequence counter (set: RX, get: TX) */
 			u16 key_len;
-			u8 key[0];
+			DECLARE_FLEX_ARRAY(u8, key);
 		} crypt;
 #ifdef CONFIG_AP_MODE
 		struct {
@@ -290,7 +290,7 @@ typedef struct ieee_param {
 		} add_sta;
 		struct {
 			u8	reserved[2];/* for set max_num_sta */
-			u8	buf[0];
+			DECLARE_FLEX_ARRAY(u8, buf);
 		} bcn_ie;
 #endif
 
@@ -301,7 +301,7 @@ typedef struct ieee_param {
 typedef struct ieee_param_ex {
 	u32 cmd;
 	u8 sta_addr[ETH_ALEN];
-	u8 data[0];
+	DECLARE_FLEX_ARRAY(u8, data);
 } ieee_param_ex;
 
 struct sta_data {
@@ -1252,7 +1252,7 @@ struct ieee80211_info_element_hdr {
 struct ieee80211_info_element {
 	u8 id;
 	u8 len;
-	u8 data[0];
+	DECLARE_FLEX_ARRAY(u8, data);
 } __attribute__((packed));
 #endif
 
@@ -1324,7 +1324,7 @@ struct ieee80211_txb {
 	u16 reserved;
 	u16 frag_size;
 	u16 payload_size;
-	struct sk_buff *fragments[0];
+	DECLARE_FLEX_ARRAY(struct sk_buff *, fragments);
 };
 
 
diff --git a/drivers/net/wireless/realtek/rtl8852bs/include/wlan_bssdef.h b/drivers/net/wireless/realtek/rtl8852bs/include/wlan_bssdef.h
index af9d502d1c73..9402c8a85132 100644
--- a/drivers/net/wireless/realtek/rtl8852bs/include/wlan_bssdef.h
+++ b/drivers/net/wireless/realtek/rtl8852bs/include/wlan_bssdef.h
@@ -66,7 +66,7 @@ typedef struct _NDIS_802_11_FIXED_IEs {
 typedef struct _NDIS_802_11_VARIABLE_IEs {
 	u8  ElementID;
 	u8  Length;
-	u8  data[1];
+	DECLARE_FLEX_ARRAY(u8, data);
 } NDIS_802_11_VARIABLE_IEs, *PNDIS_802_11_VARIABLE_IEs;
 
 typedef enum _NDIS_802_11_AUTHENTICATION_MODE {
@@ -151,7 +151,7 @@ typedef struct _NDIS_802_11_FIXED_IEs {
 typedef struct _NDIS_802_11_VARIABLE_IEs {
 	u8  ElementID;
 	u8  Length;
-	u8  data[1];
+	DECLARE_FLEX_ARRAY(u8, data);
 } NDIS_802_11_VARIABLE_IEs, *PNDIS_802_11_VARIABLE_IEs;
 
 typedef enum _NDIS_802_11_AUTHENTICATION_MODE {
diff --git a/drivers/net/wireless/realtek/rtl8852bs/phl/hal_g6/hal_sound.c b/drivers/net/wireless/realtek/rtl8852bs/phl/hal_g6/hal_sound.c
index 1d9aef7389fa..c19e15d480e1 100644
--- a/drivers/net/wireless/realtek/rtl8852bs/phl/hal_g6/hal_sound.c
+++ b/drivers/net/wireless/realtek/rtl8852bs/phl/hal_g6/hal_sound.c
@@ -127,6 +127,7 @@ u8 _get_bw_ru_end_idx(enum channel_width bw) {
 	case CHANNEL_WIDTH_160:
 	case CHANNEL_WIDTH_80_80:
 		ru_end_idx = HAL_NPDA_RU_IDX_END_160MHZ;
+	break;
 	default:
 	break;
 	}
diff --git a/drivers/net/wireless/realtek/rtl8852bs/phl/hal_g6/mac/mac_ax/security_cam.c b/drivers/net/wireless/realtek/rtl8852bs/phl/hal_g6/mac/mac_ax/security_cam.c
index c2fe4728437e..e93bef1a8f25 100644
--- a/drivers/net/wireless/realtek/rtl8852bs/phl/hal_g6/mac/mac_ax/security_cam.c
+++ b/drivers/net/wireless/realtek/rtl8852bs/phl/hal_g6/mac/mac_ax/security_cam.c
@@ -308,6 +308,7 @@ u8 check_key_index(u8 addr_cam_sec_mode, u8 key_type, u8 key_index)
 		case SEC_CAM_KEY_TYPE_UNI:
 			if (key_index <= 6)
 				return MACSUCCESS;
+			break;
 		default:
 			break;
 		}
@@ -317,6 +318,7 @@ u8 check_key_index(u8 addr_cam_sec_mode, u8 key_type, u8 key_index)
 		case SEC_CAM_KEY_TYPE_UNI:
 			if (key_index <= 6)
 				return MACSUCCESS;
+			break;
 		default:
 			break;
 		}
@@ -1033,4 +1035,4 @@ u32 mac_wowlan_secinfo(struct mac_ax_adapter *adapter,
 	}
 
 	return MACSUCCESS;
-}
\ No newline at end of file
+}
diff --git a/drivers/net/wireless/realtek/rtl8852bs/phl/hal_g6/phy/bb/halbb_api.c b/drivers/net/wireless/realtek/rtl8852bs/phl/hal_g6/phy/bb/halbb_api.c
index c8b3b1acdd5f..bb6b2da5118e 100644
--- a/drivers/net/wireless/realtek/rtl8852bs/phl/hal_g6/phy/bb/halbb_api.c
+++ b/drivers/net/wireless/realtek/rtl8852bs/phl/hal_g6/phy/bb/halbb_api.c
@@ -770,6 +770,7 @@ u8 halbb_get_txsc(struct bb_info *bb, u8 pri_ch, u8 central_ch,
 			} else {
 				txsc_idx = 14;
 			}
+			break;
 		default:
 			break;
 	}
diff --git a/drivers/net/wireless/realtek/rtl8852bs/phl/hal_g6/phy/rf/halrf_8852b/halrf_ops_rtl8852b.h b/drivers/net/wireless/realtek/rtl8852bs/phl/hal_g6/phy/rf/halrf_8852b/halrf_ops_rtl8852b.h
index a5561bc5eb18..ee417de3aa0d 100644
--- a/drivers/net/wireless/realtek/rtl8852bs/phl/hal_g6/phy/rf/halrf_8852b/halrf_ops_rtl8852b.h
+++ b/drivers/net/wireless/realtek/rtl8852bs/phl/hal_g6/phy/rf/halrf_8852b/halrf_ops_rtl8852b.h
@@ -23,7 +23,7 @@
  *
  *****************************************************************************/
 #ifndef __HALRF_OPS_RTL8852B_H__
-#define __HALRF_OPS_RTL8852B__
+#define __HALRF_OPS_RTL8852B_H__
 #ifdef RF_8852B_SUPPORT
 
 
diff --git a/drivers/net/wireless/realtek/rtl8852bs/phl/test/verify/phl_test_verify.c b/drivers/net/wireless/realtek/rtl8852bs/phl/test/verify/phl_test_verify.c
index f52af2f557bb..ddb537280d5f 100644
--- a/drivers/net/wireless/realtek/rtl8852bs/phl/test/verify/phl_test_verify.c
+++ b/drivers/net/wireless/realtek/rtl8852bs/phl/test/verify/phl_test_verify.c
@@ -109,6 +109,7 @@ u8 verify_bp_handler(void *ctx, struct test_bp_info *bp_info)
 			_os_sema_up(ver_ctx->phl_com->drv_priv, &(ver_ctx->cmd_sema));
 			phl_status = RTW_PHL_STATUS_SUCCESS;
 		}
+		break;
 	default:
 		break;
 	}
-- 
2.47.0

