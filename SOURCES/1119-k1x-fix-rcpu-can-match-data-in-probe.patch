From 8bb2188809a7689b3161429b215b6f8782a7c666 Mon Sep 17 00:00:00 2001
From: yanhaodong <haodong.yan@spacemit.com>
Date: Wed, 28 Aug 2024 15:09:01 +0800
Subject: [PATCH 1119/1448] k1x:fix rcpu-can match data in probe

Change-Id: If9a4dc69fc2ef3f78180b80f5688f437aa2f0813
---
 drivers/net/can/flexcan/flexcan-core.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/drivers/net/can/flexcan/flexcan-core.c b/drivers/net/can/flexcan/flexcan-core.c
index 549b4092b733..d5c0e0cc7e42 100644
--- a/drivers/net/can/flexcan/flexcan-core.c
+++ b/drivers/net/can/flexcan/flexcan-core.c
@@ -2254,6 +2254,10 @@ static int flexcan_probe(struct platform_device *pdev)
 	of_id = of_match_device(flexcan_of_match, &pdev->dev);
 	if (of_id)
 		devtype_data = of_id->data;
+	else if (of_match_device(r_flexcan_of_match, &pdev->dev)) {
+		of_id = of_match_device(r_flexcan_of_match, &pdev->dev);
+		devtype_data = of_id->data;
+	}
 	else if (platform_get_device_id(pdev)->driver_data)
 		devtype_data = (struct flexcan_devtype_data *)
 			platform_get_device_id(pdev)->driver_data;
-- 
2.47.0

