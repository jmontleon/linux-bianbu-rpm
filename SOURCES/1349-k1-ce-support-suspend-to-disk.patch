From 3e848d807d42f8e9399de99ee87a0c53dfa8fa56 Mon Sep 17 00:00:00 2001
From: Nell <xianbin.zhu@spacemit.com>
Date: Tue, 29 Oct 2024 15:18:04 +0800
Subject: [PATCH 1349/1448] k1:ce: support suspend to disk

Change-Id: I48a37426086150868266852cbe26aafd304c70dd
---
 drivers/crypto/spacemit/spacemit_ce_engine.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/drivers/crypto/spacemit/spacemit_ce_engine.c b/drivers/crypto/spacemit/spacemit_ce_engine.c
index 13a597f608c3..033ce6531b2b 100644
--- a/drivers/crypto/spacemit/spacemit_ce_engine.c
+++ b/drivers/crypto/spacemit/spacemit_ce_engine.c
@@ -37,6 +37,7 @@
 #include "spacemit_engine.h"
 #include <linux/pm_runtime.h>
 #include <linux/pm_qos.h>
+#include <linux/pm.h>
 
 struct device *dev;
 unsigned char *in_buffer, *out_buffer;
@@ -1893,8 +1894,8 @@ static int spacemit_aes_resume_noirq(struct device *dev)
 }
 
 static const struct dev_pm_ops spacemit_aes_pm_qos = {
-	.suspend_noirq = spacemit_aes_suspend_noirq,
-	.resume_noirq = spacemit_aes_resume_noirq,
+	SET_NOIRQ_SYSTEM_SLEEP_PM_OPS(spacemit_aes_suspend_noirq,
+			spacemit_aes_resume_noirq)
 };
 #endif
 
-- 
2.47.0

