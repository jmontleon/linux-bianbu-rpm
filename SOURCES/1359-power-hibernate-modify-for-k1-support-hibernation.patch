From 3dfb6e01c60920ce5c888e520fa845648b285a22 Mon Sep 17 00:00:00 2001
From: zhangmeng <zhangmeng.kevin@spacemit.com>
Date: Wed, 11 Dec 2024 19:10:19 +0800
Subject: [PATCH 1359/1451] power: hibernate: modify for k1 support hibernation

Change-Id: I086b45f70068a3ee77225d38ddc32ebdf69415be
---
 kernel/power/hibernate.c | 15 +++++++++++++++
 1 file changed, 15 insertions(+)

diff --git a/kernel/power/hibernate.c b/kernel/power/hibernate.c
index 8d35b9f9aaa3..e2771ce8a943 100644
--- a/kernel/power/hibernate.c
+++ b/kernel/power/hibernate.c
@@ -171,8 +171,13 @@ static void platform_end(int platform_mode)
 
 static int platform_pre_snapshot(int platform_mode)
 {
+#ifdef CONFIG_SOC_SPACEMIT_K1X
+	return (/* platform_mode && */ hibernation_ops) ?
+		hibernation_ops->pre_snapshot() : 0;
+#else
 	return (platform_mode && hibernation_ops) ?
 		hibernation_ops->pre_snapshot() : 0;
+#endif
 }
 
 /**
@@ -201,8 +206,13 @@ static void platform_leave(int platform_mode)
  */
 static void platform_finish(int platform_mode)
 {
+#ifdef CONFIG_SOC_SPACEMIT_K1X
+	if (/* platform_mode && */ hibernation_ops)
+		hibernation_ops->finish();
+#else
 	if (platform_mode && hibernation_ops)
 		hibernation_ops->finish();
+#endif
 }
 
 /**
@@ -217,8 +227,13 @@ static void platform_finish(int platform_mode)
  */
 static int platform_pre_restore(int platform_mode)
 {
+#ifdef CONFIG_SOC_SPACEMIT_K1X
+	return (/* platform_mode && */ hibernation_ops) ?
+		hibernation_ops->pre_restore() : 0;
+#else
 	return (platform_mode && hibernation_ops) ?
 		hibernation_ops->pre_restore() : 0;
+#endif
 }
 
 /**
-- 
2.47.0

