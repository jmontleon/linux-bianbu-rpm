From 2661852e000aff039c449af4f5830f57fe213c9f Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?=E7=8E=8B=E6=A5=9A?= <chu.wang@spacemit.com>
Date: Wed, 27 Sep 2023 19:25:54 +0800
Subject: [PATCH 0149/1451] add tcm_cfg_save/restore

Change-Id: Idb486570aeecbf530d3cee1d5a363d4b2b04bb7c
---
 arch/riscv/include/asm/csr.h | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/arch/riscv/include/asm/csr.h b/arch/riscv/include/asm/csr.h
index 777cb8299551..e48e9b667929 100644
--- a/arch/riscv/include/asm/csr.h
+++ b/arch/riscv/include/asm/csr.h
@@ -393,6 +393,11 @@
 #define CSR_VTYPE		0xc21
 #define CSR_VLENB		0xc22
 
+#ifdef CONFIG_SOC_SPACEMIT_K1X
+/* TCM enable register */
+#define CSR_TCMCFG		0x5db
+#endif
+
 #ifdef CONFIG_RISCV_M_MODE
 # define CSR_STATUS	CSR_MSTATUS
 # define CSR_IE		CSR_MIE
@@ -513,6 +518,11 @@
 			      : "memory");			\
 })
 
+#ifdef CONFIG_SOC_SPACEMIT_K1X
+#define tcm_config_save()		csr_read(CSR_TCMCFG)
+#define tcm_config_restore(flags)	csr_set(CSR_TCMCFG, flags)
+#endif
+
 #endif /* __ASSEMBLY__ */
 
 #endif /* _ASM_RISCV_CSR_H */
-- 
2.47.0

