From e18dc45087d8c1a16ca7011f3fcc8ff4c7acc000 Mon Sep 17 00:00:00 2001
From: wanlong <long.wan@spacemit.com>
Date: Fri, 15 Nov 2024 11:30:34 +0800
Subject: [PATCH 1280/1448] usb: typec: husb239: enable wakeup source in
 i2c_device_probe() instead of husb239

Change-Id: I040e01a7ce7e3c9eaa0052b8961185ab5f361ed0
---
 drivers/usb/typec/husb239.c | 10 ----------
 1 file changed, 10 deletions(-)

diff --git a/drivers/usb/typec/husb239.c b/drivers/usb/typec/husb239.c
index a7cf95544bd9..353710495747 100644
--- a/drivers/usb/typec/husb239.c
+++ b/drivers/usb/typec/husb239.c
@@ -1159,11 +1159,6 @@ static int husb239_probe(struct i2c_client *client)
 		goto err_unreg_switch;
 	}
 
-	if (of_property_read_bool(husb239->dev->of_node, "wakeup-source")) {
-		device_init_wakeup(husb239->dev, true);
-		dev_pm_set_wake_irq(husb239->dev, husb239->gpio_irq);
-	}
-
 	return 0;
 
 err_unreg_switch:
@@ -1182,11 +1177,6 @@ static void husb239_remove(struct i2c_client *client)
 	if (husb239->workqueue)
 		destroy_workqueue(husb239->workqueue);
 
-	if (device_may_wakeup(husb239->dev)) {
-		dev_pm_clear_wake_irq(husb239->dev);
-		device_init_wakeup(husb239->dev, false);
-	}
-
 	typec_switch_unregister(info->sw);
 	typec_unregister_port(info->port);
 	usb_role_switch_put(info->role_sw);
-- 
2.47.0

