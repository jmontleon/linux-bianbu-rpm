From f9dd1d6a2158611c9230e659f7e1046e5cf5580d Mon Sep 17 00:00:00 2001
From: Nell <xianbin.zhu@spacemit.com>
Date: Tue, 29 Oct 2024 15:21:50 +0800
Subject: [PATCH 1351/1451] k1:usb: support suspend to disk

Change-Id: I3fd1b8dd8a19a1bb267c4edd2bac6b9eeb570b7b
---
 drivers/usb/gadget/udc/k1x_udc_core.c | 3 +--
 drivers/usb/host/ehci-k1x-ci.c        | 3 +--
 drivers/usb/phy/phy-k1x-ci-otg.c      | 3 +--
 3 files changed, 3 insertions(+), 6 deletions(-)

diff --git a/drivers/usb/gadget/udc/k1x_udc_core.c b/drivers/usb/gadget/udc/k1x_udc_core.c
index 157a0d90dac2..268ee8ffef30 100644
--- a/drivers/usb/gadget/udc/k1x_udc_core.c
+++ b/drivers/usb/gadget/udc/k1x_udc_core.c
@@ -2641,8 +2641,7 @@ static int mv_udc_resume(struct device *dev)
 }
 
 static const struct dev_pm_ops mv_udc_pm_ops = {
-	.suspend	= mv_udc_suspend,
-	.resume		= mv_udc_resume,
+	SET_SYSTEM_SLEEP_PM_OPS(mv_udc_suspend, mv_udc_resume)
 };
 #endif
 
diff --git a/drivers/usb/host/ehci-k1x-ci.c b/drivers/usb/host/ehci-k1x-ci.c
index 16803b344d7b..097b85e1ae16 100644
--- a/drivers/usb/host/ehci-k1x-ci.c
+++ b/drivers/usb/host/ehci-k1x-ci.c
@@ -619,8 +619,7 @@ static int mv_ehci_resume(struct device *dev)
 #endif /* CONFIG_PM_SLEEP */
 
 static const struct dev_pm_ops mv_ehci_pm_ops = {
-	.suspend	= mv_ehci_suspend,
-	.resume		= mv_ehci_resume,
+	SET_SYSTEM_SLEEP_PM_OPS(mv_ehci_suspend, mv_ehci_resume)
 };
 
 static struct platform_driver ehci_k1x_driver = {
diff --git a/drivers/usb/phy/phy-k1x-ci-otg.c b/drivers/usb/phy/phy-k1x-ci-otg.c
index 5235e71f1ba6..7bf8995347cb 100644
--- a/drivers/usb/phy/phy-k1x-ci-otg.c
+++ b/drivers/usb/phy/phy-k1x-ci-otg.c
@@ -843,8 +843,7 @@ static int mv_otg_resume(struct device *dev)
 }
 
 static const struct dev_pm_ops mv_otg_pm_ops = {
-	.suspend	= mv_otg_suspend,
-	.resume		= mv_otg_resume,
+	SET_SYSTEM_SLEEP_PM_OPS(mv_otg_suspend, mv_otg_resume)
 };
 
 #endif
-- 
2.47.0

