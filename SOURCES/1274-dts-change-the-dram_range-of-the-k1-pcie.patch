From ec0ea4ded86a0a60a5a52c81c46d2f3333c9c7e9 Mon Sep 17 00:00:00 2001
From: huzhen <george.hu@spacemit.com>
Date: Fri, 15 Nov 2024 09:32:17 +0800
Subject: [PATCH 1274/1448] dts: change the dram_range of the k1 pcie

Change-Id: Ibba491b7fa693632054379b03165205759e1a63d
---
 arch/riscv/boot/dts/spacemit/k1-x.dtsi | 32 ++++++++++++++++++++++----
 1 file changed, 28 insertions(+), 4 deletions(-)

diff --git a/arch/riscv/boot/dts/spacemit/k1-x.dtsi b/arch/riscv/boot/dts/spacemit/k1-x.dtsi
index b37042f4b7cd..b701b59585ca 100644
--- a/arch/riscv/boot/dts/spacemit/k1-x.dtsi
+++ b/arch/riscv/boot/dts/spacemit/k1-x.dtsi
@@ -507,13 +507,13 @@ dram_range1: dram_range@1 {
 			status = "okay";
 		};
 
-		/* dram mapping for pcie for ex. */
+		/* dram mapping for pcie0 for ex. */
 		dram_range2: dram_range@2 {
 			compatible = "spacemit-dram-bus";
 			#address-cells = <2>;
 			#size-cells = <2>;
 			dma-ranges = <0x0 0x00000000 0x0 0x00000000 0x0 0x80000000>,
-				     <0x0 0xb8000000 0x1 0x38000000 0x3 0x48000000>;
+				     <0x0 0x90000000 0x1 0x10000000 0x3 0x70000000>;
 			#interconnect-cells = <0>;
 			status = "okay";
 		};
@@ -551,6 +551,30 @@ dram_range5: dram_range@5 {
 			status = "okay";
 		};
 
+		/* dram mapping for pcie1 for ex. */
+		dram_range6: dram_range@6 {
+			compatible = "spacemit-dram-bus";
+			#address-cells = <2>;
+			#size-cells = <2>;
+			dma-ranges = <0x0 0x00000000 0x0 0x00000000 0x0 0x80000000>,
+				     <0x0 0x80000000 0x1 0x00000000 0x0 0x10000000>,
+				     <0x0 0xa0000000 0x1 0x20000000 0x3 0x60000000>;
+			#interconnect-cells = <0>;
+			status = "okay";
+		};
+
+		/* dram mapping for pcie2 for ex. */
+		dram_range7: dram_range@7 {
+			compatible = "spacemit-dram-bus";
+			#address-cells = <2>;
+			#size-cells = <2>;
+			dma-ranges = <0x0 0x00000000 0x0 0x00000000 0x0 0x80000000>,
+				     <0x0 0x80000000 0x1 0x00000000 0x0 0x20000000>,
+				     <0x0 0xb8000000 0x1 0x38000000 0x3 0x48000000>;
+			#interconnect-cells = <0>;
+			status = "okay";
+		};
+
 		clint0: clint@e4000000 {
 			compatible = "riscv,clint0";
 			interrupts-extended = <
@@ -2251,7 +2275,7 @@ pcie1_rc: pcie@ca400000 {
 			#size-cells = <2>;
 			ranges = <0x01000000 0x0 0x9f002000 0 0x9f002000 0x0 0x100000>,
 				 <0x02000000 0x0 0x90000000 0 0x90000000 0x0 0x0f000000>;
-			interconnects = <&dram_range2>;
+			interconnects = <&dram_range6>;
 			interconnect-names = "dma-mem";
 
 			interrupts = <142>, <146>;
@@ -2301,7 +2325,7 @@ pcie2_rc: pcie@ca800000 {
 			ranges = <0x01000000 0x0 0xb7002000 0 0xb7002000 0x0 0x100000>,
 				 <0x42000000 0x0 0xa0000000 0 0xa0000000 0x0 0x10000000>,
 				 <0x02000000 0x0 0xb0000000 0 0xb0000000 0x0 0x7000000>;
-			interconnects = <&dram_range2>;
+			interconnects = <&dram_range7>;
 			interconnect-names = "dma-mem";
 
 			interrupts = <143>, <147>;
-- 
2.47.0

